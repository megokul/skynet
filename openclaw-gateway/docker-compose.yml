version: "3.9"

services:
  gateway:
    build: .
    container_name: openclaw-gateway
    restart: unless-stopped
    ports:
      - "8765:8765"   # WebSocket (agent connection)
      - "8766:8766"   # HTTP API (internal)
    volumes:
      - gateway-data:/app/data
      - ${OPENCLAW_TLS_CERT_DIR:-./certs}:/app/certs:ro
    environment:
      # Required
      - OPENCLAW_AUTH_TOKEN
      - TELEGRAM_BOT_TOKEN
      # AI providers (optional â€” set whichever you have)
      - GOOGLE_AI_API_KEY
      - GROQ_API_KEY
      - OPENROUTER_API_KEY
      - DEEPSEEK_API_KEY
      - OPENAI_API_KEY
      - ANTHROPIC_API_KEY
      # Search
      - BRAVE_SEARCH_API_KEY
      # GitHub
      - GITHUB_PAT
      - GITHUB_USERNAME
      # AWS S3
      - AWS_ACCESS_KEY_ID
      - AWS_SECRET_ACCESS_KEY
      - AWS_DEFAULT_REGION=${AWS_DEFAULT_REGION:-us-east-1}
      - OPENCLAW_S3_BUCKET
      # TLS (paths inside container)
      - OPENCLAW_TLS_CERT=/app/certs/cert.pem
      - OPENCLAW_TLS_KEY=/app/certs/key.pem
      # Logging
      - OPENCLAW_LOG_LEVEL=${OPENCLAW_LOG_LEVEL:-INFO}
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

volumes:
  gateway-data:
    driver: local
