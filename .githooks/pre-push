#!/usr/bin/env sh
set -eu

# Set SKYNET_SKIP_ENV_SYNC=1 to bypass this sync for a single push.
if [ "${SKYNET_SKIP_ENV_SYNC:-0}" = "1" ]; then
  exit 0
fi

if [ ! -f ".env" ]; then
  exit 0
fi

if command -v python >/dev/null 2>&1; then
  python scripts/dev/sync_env_to_github.py --mode secrets --quiet
elif command -v py >/dev/null 2>&1; then
  py -3 scripts/dev/sync_env_to_github.py --mode secrets --quiet
else
  echo "pre-push: Python not found. Install Python or set SKYNET_SKIP_ENV_SYNC=1." >&2
  exit 1
fi
